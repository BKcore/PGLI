<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Editor</title>
  <link rel="stylesheet" type="text/css" href="css/main.css">
  <link rel="stylesheet" type="text/css" href="css/editor.css">
  <link rel="stylesheet" type="text/css" href="fonts/ubuntu-mono/font.css">
  </style>
</head>
<body>

<div id="modules">
<ul>
  <li>Façade.pmod</li>
  <li>Test.pmod</li>
  <li>Test.pmod</li>
  <li>Test.pmod</li>
  <li>Test.pmod</li>
  <li>Test.pmod</li>
  <li>Test.pmod</li>
</ul>
</div>

<div id="editor">

</div>

<div id="editor-separator"></div>

<div id="diagram">
 	
</div>
	
<script src="libs/jquery-1.8.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/kinetic.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/bkcore/Timer.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/gamecore/class.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/gamecore/gamecore.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/gamecore/jhashtable.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/gamecore/pooled.js" type="text/javascript" charset="utf-8"></script>
<script src="libs/gamecore/hashlist.js" type="text/javascript" charset="utf-8"></script>

<script src="pgli/diagram/Diagram.js" type="text/javascript" charset="utf-8"></script>
<script src="pgli/diagram/Links.js" type="text/javascript" charset="utf-8"></script>
<script src="pgli/diagram/Node.js" type="text/javascript" charset="utf-8"></script>
<script src="pgli/render/CanvasRenderer.js" type="text/javascript" charset="utf-8"></script>

<script>
/*pgli.Project = gamecore.Base.extend({

},
{
	init: function("/files/facade.pmod")
	{

			{
				layers: [
					{
						"use": "subparts/floor.pmod"
					}
				]
			}
	}
	files: Hashtable({"/batiments/facade.mod":"facade.pmod"})
	modules: Hashtable({"facade.pmod": {Module{code:string, object: JSON.parse}}})
	name: "nom",
	path: "/files/",
	root: "facade.pmod",
	diagram: new Diagram(),
	updateDiagram: function()
	{

	}
	render: function(canvasRenderer)
	{
		canvasRenderer.Render(modules, root, new Hashtable());
	}
})

var toto = '{
	"name": "Facade",
	"desc": "Facade template example",

	"width": 1000,
	"height": 2000,

	"unit": "cm",
	"pixelratio": 0.5,

	"origin": "bottom left",

	"params" : {
		"style": "urban",
		"floorheight": 200,
		"decaydensity": 10
	},

	"vars" : {
		"nbfloors": "@height mod @floorheight"
	},

	"layers": [
		{
			"use": "wall.pmod",
		},
		{
			"use": "decay.mod",
			"repeat": "@i 0 < @decaydensity"
		},
		{
			"use": "floor.pmod",
			"repeat": "@i 0 < @nbfloors",

			"height": "@floorheight",
			"y": "@i * @floorheight" 
		}
	]
}';*/

</script>

<script>
	var editor = ace.edit("editor");
	editor.setFontSize("16px");
	editor.setTheme("ace/theme/monokai");
	editor.getSession().setMode("ace/mode/json");

	$(function() {
		$.ajax({
			url : "files/facade.pmod",
			dataType: "text",
			success : function (data) {
				editor.getSession().setValue(data);
			}
		});

		var diagDom = $("#diagram");
		var diagram = new pgli.diagram.Diagram("diagram", diagDom.width(), diagDom.height(), 30);
		diagram.addNode(new pgli.diagram.Node({name: "Façade", layers:["Floor"]}, 100, 50));
		diagram.addNode(new pgli.diagram.Node({name: "Floor", layers: []}, 260, 110));
		window.diagram = diagram;
  }); 
</script>

</body>
</html>
